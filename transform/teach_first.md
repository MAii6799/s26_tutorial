# è§†è§‰ç¬¬ä¸‰è¯¾ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰ï¼šåæ ‡ç³»è½¬æ¢ğŸ˜‰

authorï¼š[Cinjay Jiang](https://github.com/knot41)

dateï¼š2025/4/13

---

## ä¸€ã€ä»€ä¹ˆæ˜¯åæ ‡ç³»ï¼ŸğŸ¤”

ä¾‹å­ï¼šé«˜ä¸­æ—¶å€™çš„ç«‹ä½“å‡ ä½•é—®é¢˜ã€‚

ä¸‰ç»´ç©ºé—´ä¸‹ï¼Œåæ ‡ç³» = åŸç‚¹ + ä¸‰ä¸ªè½´ï¼ˆxã€yã€zï¼‰ã€‚

æ ¹æ®å»ºç³»æ–¹å¼çš„ä¸åŒå¯ä»¥åˆ†ä¸º**å·¦æ‰‹ç³»**å’Œ**å³æ‰‹ç³»**ã€‚

![å»ºç³»åˆ¤æ–­](å»ºç³»åˆ¤æ–­.png)

### æ¯”èµ›æœºå™¨äººä¸­å¸¸è§çš„åæ ‡ç³»ğŸ«£

- `world`ï¼šä¸–ç•Œåæ ‡ç³»
- `camera`ï¼šç›¸æœºåæ ‡ç³»
- `odom`ï¼šåº•ç›˜åæ ‡ç³»
- `shoot`ï¼šå°„å‡»åæ ‡ç³»

![æœºå™¨äººä¸Šçš„åæ ‡ç³»](robot.png)

æ¯ä¸ªé›¶ä»¶éƒ½å¯ä»¥è®¤ä¸ºæœ‰è‡ªå·±çš„åæ ‡ç³»ï¼Œå½¼æ­¤ä¹‹é—´éœ€è¦**å˜æ¢**æ‰èƒ½ç»Ÿä¸€è®¤è¯†ä¸–ç•Œã€‚

---

## äºŒã€åæ ‡ç³»æ€ä¹ˆå˜æ¢ï¼ŸğŸ¤”

åæ ‡ç³»å˜æ¢ = æŠŠä¸€ä¸ªç‚¹/ç‰©ä½“ä»ä¸€ä¸ªåæ ‡ç³»è½¬æ¢åˆ°å¦ä¸€ä¸ªåæ ‡ç³»çš„æè¿°æ–¹å¼ã€‚

æœ¬è´¨ï¼šæ¢ä¸ªå‚è€ƒç‚¹æ¥çœ‹ä¸–ç•Œ

å…ˆçº¦å®šä¸€ä¸ªå¤§å‰æï¼Œåœ¨ä¸€ä¸ªåæ ‡ç³»ä¸­ç‚¹çš„åæ ‡~~åªæœ‰ä½ç½®~~çš„æè¿°ï¼Œå®é™…ä¸Šæè¿°åº”è¯¥åŒ…å«ä½ç½®å’Œå§¿æ€ã€‚ğŸ¤ª

æˆ‘ä»¬å‡è®¾ï¼š
- æœ‰ä¸¤ä¸ªåæ ‡ç³»ï¼šA å’Œ B
- ä¸€ä¸ªç‚¹ $P_b$ åœ¨ B åæ ‡ç³»ä¸‹çš„åæ ‡æ˜¯ï¼ˆxï¼Œyï¼Œzï¼‰
- æˆ‘ä»¬æƒ³æ±‚è¿™ä¸ªç‚¹åœ¨ A åæ ‡ç³»ä¸‹çš„è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯ $p_a$ã€‚

æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¿¡æ¯ï¼š

1. **B ç›¸å¯¹äº A çš„ä½ç½®ï¼ˆå¹³ç§»ï¼‰** â†’ ä¸€ä¸ªå‘é‡ $\mathbf{t}^B_A$
2. **B ç›¸å¯¹äº A çš„æœå‘ï¼ˆæ—‹è½¬ï¼‰** â†’ ä¸€ä¸ªæ—‹è½¬çŸ©é˜µ $\mathbf{R}^B_A$

é‚£ä¹ˆå…¬å¼å°±æ˜¯ï¼š

$$
\mathbf{p}_A = \mathbf{R}^B_A \cdot \mathbf{p}_B + \mathbf{t}^B_A
$$

è¿™å°±æ˜¯ä¸€ä¸ªç»å…¸çš„åæ ‡å˜æ¢(å¯æƒœåªæœ‰ä½ç½®)ï¼

### ä¸¾ä¸ªä¾‹å­è®²æ¸…æ¥š ğŸŒ°

å‡è®¾ï¼š

- B åæ ‡ç³»æ˜¯ A åæ ‡ç³»å¾€å³å¹³ç§»äº† 1 ç±³ï¼Œå¹¶ç»• Z è½´æ—‹è½¬äº† 90 åº¦
- ç‚¹ $\mathbf{p}_B = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}$

é‚£ï¼š

- $\mathbf{t}^B_A = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}$  
- $\mathbf{R}^B_A = \begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}$

è®¡ç®—ï¼š

$$
\begin{aligned}
\mathbf{p}_A &= \mathbf{R}^B_A \cdot \mathbf{p}_B + \mathbf{t}^B_A \\
&= \begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}
+ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \\
&= \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}
+ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}
= \begin{bmatrix} 1 \\ 1 \\ 0 \end{bmatrix}
\end{aligned}
$$

ä¹Ÿå°±æ˜¯è¯´ï¼šåŒä¸€ä¸ªç‚¹ï¼Œåœ¨ B é‡Œæ˜¯ (1, 0, 0)ï¼Œä½†åœ¨ A é‡Œæ˜¯ (1, 1, 0)ã€‚

> *Tip*ï¼šZ è½´å‡å‚ç›´äºå±å¹•æœå‘è‡ªå·±ã€‚
### æ›´è¿‘ä¸€æ­¥ğŸ§‘â€ğŸ”§

ä¸ºäº†æ–¹ä¾¿å¹³ç§»+æ—‹è½¬ä¸€èµ·è¡¨è¿°ï¼Œæˆ‘ä»¬æŠŠç‚¹æ‰©æˆå››ç»´ï¼ˆåŠ ä¸ª1ï¼‰ï¼š

$$
\mathbf{P}_B^{(h)} = \begin{bmatrix} x \\ y \\ z \\ 1 \end{bmatrix}
$$

é½æ¬¡å˜æ¢çŸ©é˜µ $\mathbf{T}_A^B$ æ˜¯ï¼š

$$
\mathbf{T}_A^B = \begin{bmatrix} \mathbf{R}_{3 \times 3} & \mathbf{t}_{3 \times 1} \\ \mathbf{0}_{1 \times 3} & 1 \end{bmatrix}
$$

é‚£ä¹ˆå˜æ¢å°±å†™æˆä¸€è¡Œï¼š

$$
\mathbf{P}_A^{(h)} = \mathbf{T}_A^B \cdot \mathbf{P}_B^{(h)}
$$

è¿™å°±æ˜¯æœ€æ ‡å‡†çš„åæ ‡è½¬æ¢æ“ä½œ(å¯æƒœåªæœ‰ä½ç½®)ï¼

ç‰¢è®°å£è¯€ï¼š**åæ ‡ç³»Aä¸‹çš„é½æ¬¡ä½ç½®åæ ‡ç­‰äºåæ ‡ç³»Bä¸‹çš„é½æ¬¡ä½ç½®åæ ‡å·¦ä¹˜ä¸ŠBç›¸å¯¹äºAçš„é½æ¬¡å˜æ¢çŸ©é˜µ**ã€‚ğŸ¥°

---

## ä¸‰ã€ä»€ä¹ˆæ˜¯ä½å§¿ï¼ŸğŸ¤”

**ä½å§¿** å°±æ˜¯ **ä½ç½®** å’Œ **å§¿æ€**ã€‚

ä½ç½®å°±æ˜¯ä¸‰ç»´åæ ‡ï¼Œè€Œå§¿æ€æ˜¯æè¿°ä¸€ä¸ªç‰©ä½“ç›¸å¯¹äºå‚è€ƒåæ ‡ç³»çš„æœå‘çš„æ–¹å¼ã€‚

å§¿æ€çš„è¡¨ç¤ºæ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¸€èˆ¬å¯ä»¥ç”¨å››å…ƒæ•°ã€æ—‹è½¬çŸ©é˜µã€æ—‹è½¬å‘é‡å’Œæ¬§æ‹‰è§’ç­‰æ¥è¡¨ç¤ºï¼Œè¿™å‡ ç§è¡¨ç¤ºæ–¹æ³•éƒ½å„æœ‰ä¼˜ç¼ºç‚¹ã€‚

---

## å››ã€æ—‹è½¬çŸ©é˜µæ˜¯å•¥ï¼ŸğŸ¤”

åœ¨ä¸‰ç»´ç©ºé—´ä¸­ï¼Œæ—‹è½¬çŸ©é˜µç”¨äºæè¿°ä¸€ä¸ªç‰©ä½“æˆ–åæ ‡ç³»å¦‚ä½•ç›¸å¯¹äºå¦ä¸€ä¸ªåæ ‡ç³»æ—‹è½¬ã€‚å®ƒæ˜¯ä¸€ä¸ª 3Ã—3 çš„æ­£äº¤çŸ©é˜µï¼Œç”¨äºè¡¨ç¤ºå§¿æ€ã€‚

æ—‹è½¬çŸ©é˜µæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š
- è¡Œå‘é‡ï¼ˆæˆ–åˆ—å‘é‡ï¼‰ä¸¤ä¸¤æ­£äº¤
- æ¯ä¸ªå‘é‡é•¿åº¦ä¸º1
- è¡Œåˆ—å¼ä¸º +1
- $R^{-1} = R^T$ï¼ˆå³è½¬ç½®ç­‰äºé€†ï¼‰

ä»¥ä¸‹åˆ—å‡ºäº†ç»• $x$ è½´ã€$y$ è½´ã€$z$ è½´æ—‹è½¬çš„æ ‡å‡†æ—‹è½¬çŸ©é˜µï¼š

> æ­£æ–¹å‘ï¼šå³æ‰‹æ¡ä½è½´ï¼Œå¤§æ‹‡æŒ‡æŒ‡å‘æ­£æ–¹å‘ï¼Œå…¶ä½™å››æŒ‡æ–¹å‘ä¸ºæ­£è½¬è§’æ–¹å‘ã€‚

### ç»• X è½´æ—‹è½¬ $\theta$

$$
R_x(\theta) =
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos\theta & -\sin\theta \\
0 & \sin\theta & \cos\theta
\end{bmatrix}
$$

### ç»• Y è½´æ—‹è½¬ $\theta$

$$
R_y(\theta) =
\begin{bmatrix}
\cos\theta & 0 & \sin\theta \\
0 & 1 & 0 \\
-\sin\theta & 0 & \cos\theta
\end{bmatrix}
$$

### ç»• Z è½´æ—‹è½¬ $\theta$

$$
R_z(\theta) =
\begin{bmatrix}
\cos\theta & -\sin\theta & 0 \\
\sin\theta & \cos\theta & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

## äº”ã€æ€ä¹ˆåŠ ä¸Šå§¿æ€çš„åæ ‡ç³»è½¬æ¢ï¼ŸğŸ¤”

### æˆ‘ä»¬å‡è®¾ï¼š

- ä¸¤ä¸ªåæ ‡ç³»ï¼šA å’Œ B  
- ä¸€ä¸ªç‰©ä½“ $P$ï¼Œåœ¨ **B åæ ‡ç³»ä¸‹**çš„ï¼š
  - ä½ç½®æ˜¯ $\mathbf{p}_B$
  - å§¿æ€æ˜¯ä¸€ä¸ªæ—‹è½¬çŸ©é˜µ $\mathbf{R}_B^P$ï¼ˆè¡¨ç¤ºç‰©ä½“è‡ªèº«åæ ‡è½´ç›¸å¯¹Båæ ‡è½´çš„æ—‹è½¬ï¼‰
- æˆ‘ä»¬çŸ¥é“ **B ç›¸å¯¹äº A** çš„å˜æ¢å…³ç³»ï¼š
  - å¹³ç§»ï¼š$\mathbf{t}_A^B$
  - æ—‹è½¬ï¼š$\mathbf{R}_A^B$

---

### é‚£ä¹ˆåœ¨ A åæ ‡ç³»ä¸‹çš„ä½å§¿å°±æ˜¯ï¼š

#### âœ… ä½ç½®å˜æ¢ï¼š

$$
\mathbf{p}_A = \mathbf{R}_A^B \cdot \mathbf{p}_B + \mathbf{t}_A^B
$$

#### âœ… å§¿æ€å˜æ¢ï¼š

$$
\mathbf{R}_A^P = \mathbf{R}_A^B \cdot \mathbf{R}_B^P
$$

å§¿æ€ç›´æ¥ä¹˜ä¸Šæ—‹è½¬çŸ©é˜µ(å·¦ä¹˜)ï¼Œä½ç½®è¿˜æ˜¯å…ˆæ—‹è½¬åå¹³ç§»ï¼Œåˆ«æåå•¦ï¼ğŸ¤ª

---

### ä¸¾ä¸ªä¾‹å­è®²æ¸…æ¥š ğŸŒ°

å‡è®¾ï¼š

- B åæ ‡ç³»ç›¸å¯¹ Aï¼š
  - å¾€å³ç§»äº† 1 ç±³  
  - ç»• Z è½´é€†æ—¶é’ˆè½¬äº† 90 åº¦
- ç‚¹ $P$ åœ¨ B ä¸­çš„ä½ç½®ï¼š
  $$
  \mathbf{p}_B = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}
  $$
- ç‚¹ $P$ çš„æœå‘ï¼ˆç»•Zè½´è½¬äº† -90Â°ï¼‰ï¼š
  $$
  \mathbf{R}_B^P = \begin{bmatrix} 0 & 1 & 0 \\ -1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}
  $$

å˜æ¢çŸ©é˜µï¼š

- $\mathbf{t}_A^B = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}$
- $\mathbf{R}_A^B = \begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}$

è®¡ç®—ä½ç½®ï¼š

$$
\mathbf{p}_A = \mathbf{R}_A^B \cdot \mathbf{p}_B + \mathbf{t}_A^B = 
\begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} + \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}
= \begin{bmatrix} 1 \\ 1 \\ 0 \end{bmatrix}
$$

è®¡ç®—å§¿æ€ï¼š

$$
\mathbf{R}_A^P = \mathbf{R}_A^B \cdot \mathbf{R}_B^P = 
\begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}
\begin{bmatrix} 0 & 1 & 0 \\ -1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}
= \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}
$$

ä¸å¯¹ï¼æ€ä¹ˆå˜æˆå•ä½çŸ©é˜µäº†ï¼Ÿå•ä½çŸ©é˜µè¡¨ç¤ºå•¥å§¿æ€å‘¢ï¼Ÿ

å…¶å®ä¸Šï¼Œå•ä½çŸ©é˜µå°±ä»£è¡¨æ²¡æœ‰å§¿æ€ä¸Šçš„å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯è¯´ç‚¹ $P$ åœ¨ A åæ ‡ç³»ä¸‹çš„ä½å§¿å°±æ˜¯ A åæ ‡ç³»çš„æ ‡å‡†ç³»ã€‚

---

### æ›´è¿›ä¸€æ­¥ğŸ§‘â€ğŸ”§

æˆ‘ä»¬ç»§ç»­â€œé½æ¬¡å½¢å¼â€å¤§æ³•ï¼

æŠŠæ•´ä¸ª**ä½å§¿**æ‰“åŒ…æˆä¸€ä¸ªé½æ¬¡çŸ©é˜µï¼š

$$
\mathbf{T}_B^P = 
\begin{bmatrix}
\mathbf{R}_B^P & \mathbf{p}_B \\
\mathbf{0}_{1 \times 3} & 1
\end{bmatrix}
$$

Bç›¸å¯¹äºAçš„å˜æ¢çŸ©é˜µæ˜¯ï¼š

$$
\mathbf{T}_A^B = 
\begin{bmatrix}
\mathbf{R}_A^B & \mathbf{t}_A^B \\
\mathbf{0}_{1 \times 3} & 1
\end{bmatrix}
$$

é‚£ä¹ˆï¼š

$$
\mathbf{T}_A^P = \mathbf{T}_A^B \cdot \mathbf{T}_B^P
$$

è¿™å°±æ˜¯æœ€æœ€æœ€æ ‡å‡†çš„åæ ‡è½¬æ¢æ“ä½œ(åŒ…å«ä½ç½®å’Œå§¿æ€)ï¼

ç‰¢è®°å£è¯€ï¼š**ç‰©ä½“åœ¨ A åæ ‡ç³»ä¸‹çš„ä½å§¿ = å®ƒåœ¨ B åæ ‡ç³»ä¸‹çš„ä½å§¿å·¦ä¹˜ B ç›¸å¯¹äº A çš„é½æ¬¡å˜æ¢çŸ©é˜µ**ã€‚ğŸ¥°

*Tip*: (è¿™é‡Œçš„ä½å§¿è¦å†™æˆé½æ¬¡å˜æ¢çŸ©é˜µçš„å½¢å¼ï¼Œæ„Ÿè§‰å¯ä»¥å«é½æ¬¡ä½å§¿çŸ©é˜µ)
